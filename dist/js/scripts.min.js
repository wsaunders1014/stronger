$(document).ready(function(){function e(e){if(e.preventDefault(),$(".error").html(""),this.files[0].size/1e3/1024>150)return $(".error").html("File size must be under 150mb."),t(),!1;$("progress").show(),$("#create-btn").find("img").addClass("disabled");var o=new FormData($("#video-upload")[0]);$("#spinner").show(),$.ajax({url:"/upload",type:"POST",contentType:!1,data:o,processData:!1,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){e.lengthComputable&&$("progress").attr({value:e.loaded,max:e.total})},!1),e}}).done(function(e){console.log(e),e.error?($("#spinner").hide(),$(".error").html(e.message),t()):($("#spinner").hide(),"video"==e.type?($("#preview").html('<video autoplay preload loop controls><source src="'+e.video_url+'"/></video>'),$("#preview").find("video")[0].load()):($("#preview").html('<img src="'+e.video_url+'"/>'),e.videoH<.5625*e.videoW&&$("#preview").find("img").addClass("landscape")),$("#create").hide(),$("#share").show(),$("#download-btn").find("a").attr("href",e.video_url),$("#facebook-btn").attr("data-url",e.video_url),$("#twitter-btn").attr("data-url",e.video_url),console.log("Time Elapsed: "+e.timeElapsed+" seconds"))})}function t(){$("#share").hide(),$("#create-btn").find("img").removeClass("disabled"),$("progress").hide(),$("#spinner").hide(),$("#create").show(),$("#video").one("change",e)}$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"1956267324660722",version:"v2.7"})}),location.query&&console.log(location.pathname),$("#video").one("change",e),$("#restart-btn").click(t),$("#facebook-btn").click(function(){FB&&FB.ui({method:"share",hashtag:"#strongermovie",href:$("#facebook-btn").attr("data-url")},function(e){console.log("shared")})}),$("#twitter-btn").click(function(){$.post("/authTwitter",{url:$(this).attr("data-url")}).done(function(e){location.href="https://twitter.com/oauth/authenticate?oauth_token="+e.requestToken})})});